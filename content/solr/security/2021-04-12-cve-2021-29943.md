Title: CVE-2021-29943: Apache Solr Unprivileged users may be able to perform unauthorized read/write to collections
category: solr/security
cve: CVE-2021-29943

**Severity:**
High

**Versions Affected:**
7.0.0 to 7.7.3
8.0.0 to 8.8.1

**Description:**
When using ConfigurableInternodeAuthHadoopPlugin for authentication, Apache Solr versions prior to 8.8.2 would forward/proxy distributed requests using server credentials instead of original client credentials. This would result in incorrect authorization resolution on the receiving hosts.

**Mitigation:**
Any of the following are enough to prevent this vulnerability:

* Upgrade to `Solr 8.8.2` or greater.
* If upgrading is not an option, consider applying the patch in [SOLR-15233](https://issues.apache.org/jira/browse/SOLR-15233)
* Use a different authentication plugin, such as the KerberosPlugin or HadoopAuthPlugin

**Credit:**
Geza Nagy

**References:**
[SOLR-15233](https://issues.apache.org/jira/browse/SOLR-15233): CVE-2021-29943: Apache Solr Unprivileged users may be able to perform unauthorized read/write to collections 
