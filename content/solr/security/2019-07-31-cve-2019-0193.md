Title: CVE-2019-0193: Apache Solr, Remote Code Execution via DataImportHandler
category: solr/security
cve: CVE-2019-0193

**Severity:** High

**Vendor:**  
The Apache Software Foundation

**Versions Affected:**

* 5.0.0 to 5.5.5
* 6.0.0 to 6.6.5

**Description:**  
The DataImportHandler, an optional but popular module to pull in data from
databases and other sources, has a feature in which the whole DIH
configuration can come from a request's "dataConfig" parameter. The debug
mode of the DIH admin screen uses this to allow convenient debugging /
development of a DIH config. Since a DIH config can contain scripts, this
parameter is a security risk. Starting with version 8.2.0 of Solr, use of
this parameter requires setting the Java System property
`enable.dih.dataConfigParam` to true.

**Mitigation:**  

* Upgrade to 8.2.0 or later, which is secure by default.
* or, edit solrconfig.xml to configure all DataImportHandler usages with an "invariants" section listing the "dataConfig" parameter set to am empty string.
* Ensure your network settings are configured so that only trusted traffic communicates with Solr, especially to the DIH request handler.  This is a best practice to all of Solr.

**Credit:**  
Michael Stepankin (JPMorgan Chase)

**References:**

* <https://issues.apache.org/jira/browse/SOLR-13669>
* <https://cwiki.apache.org/confluence/display/SOLR/SolrSecurity>

