Title: CVE-2021-27905: SSRF vulnerability with the Replication handler
category: solr/security
cve: CVE-2021-27905

**Severity:**
High

**Versions Affected:**
7.0.0 to 7.7.3
8.0.0 to 8.8.1

**Description:**
The ReplicationHandler (normally registered at "/replication" under a Solr core) has a "masterUrl" (also "leaderUrl" alias) parameter that is used to designate another ReplicationHandler on another Solr core to replicate index data into the local core.
To prevent a SSRF vulnerability, Solr ought to check these parameters against a similar configuration it uses for the "shards" parameter.  Prior to this bug getting fixed, it did not.

**Mitigation:**
Any of the following are enough to prevent this vulnerability:

* Upgrade to `Solr 8.8.2` or greater.
* If upgrading is not an option, consider applying the patch in [SOLR-15217](https://issues.apache.org/jira/browse/SOLR-15217)
* Ensure that any access to the replication handler is purely internal to Solr.  Typically, it's only accessed externally for diagnostic/informational purposes.

**Credit:**
Reported by Caolinhong(Skay) from QI-ANXIN Cert (QI-ANXIN Technology Group Inc.)

**References:**
[SOLR-15217](https://issues.apache.org/jira/browse/SOLR-15217): CVE-2021-27905: SSRF vulnerability with the Replication handler
